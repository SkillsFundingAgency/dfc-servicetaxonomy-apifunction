parameters:
  AzureSubscription: 'SFA-CDH-Dev/Test (962cae10-2950-412a-93e3-d8ae92b17896)'
  PackageFile: ''
  ApimImportScript: ''
  SharedResourceGroup: ''
  ApimServiceName: ''
  ApiName: ''
  SpecificationFile: ''


steps:
- task: AzureRmWebAppDeployment@4
  displayName: 'Azure App Service Deploy: ${{ parameters.ResourceName }}'
  inputs:
    azureSubscription: '${{ parameters.AzureSubscription }}'
    appType: functionApp
    WebAppName: '${{ parameters.ResourceName }}'
    packageForLinux: '$(System.ArtifactsDirectory)/${{ parameters.PackageFile }}'

# TODO: replace PH in  yaml

- task: AzurePowerShell@3
  displayName: 'Import OpenAPI specification'
  inputs:
    azureSubscription: '${{ parameters.AzureSubscription }}'
    ScriptPath: '$(Build.BinariesDirectory)Import-ApimSwaggerApiDefinition.ps1'
    ScriptArguments: "-ApimResourceGroup '${{ parameters.SharedResourceGroup }}' -InstanceName '${{ parameters.ApimServiceName }}' -ApiName '${{ parameters.ApiName }} -OpenApiSpecificationFile '${{ parameters.SpecificationFile }}'"
    azurePowerShellVersion: LatestVersion
    